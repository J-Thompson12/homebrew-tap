# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Gitops < Formula
  desc "GitOps support for Kubernetes"
  homepage "https://docs.gitops.weave.works/docs/getting-started"
  version "0.3.8-rc5"

  on_macos do
    if Hardware::CPU.arm?
      url "https://github.com/J-Thompson12/weave-gitops/releases/download/v0.3.8-rc5/gitops-darwin-arm64"
      sha256 "66f6c7d9973ae3870f61f9ee75e38a1b6a7eea9079cc146a7652af571fad2f34"

      def install
        bin.install "gitops"
        bash_output = Utils.safe_popen_read(bin/"gitops", "completion", "bash")
        (bash_completion/"gitops").write bash_output
        zsh_output = Utils.safe_popen_read(bin/"gitops", "completion", "zsh")
        (zsh_completion/"_gitops").write zsh_output
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/J-Thompson12/weave-gitops/releases/download/v0.3.8-rc5/gitops-darwin-x86_64"
      sha256 "64b3a4313ff6f0cc30d7901bb2129c85123b9bb6cabbc45fc96cf84290ba90c9"

      def install
        bin.install "gitops"
        bash_output = Utils.safe_popen_read(bin/"gitops", "completion", "bash")
        (bash_completion/"gitops").write bash_output
        zsh_output = Utils.safe_popen_read(bin/"gitops", "completion", "zsh")
        (zsh_completion/"_gitops").write zsh_output
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      url "https://github.com/J-Thompson12/weave-gitops/releases/download/v0.3.8-rc5/gitops-linux-x86_64"
      sha256 "40dda1666890be86c6e66f6cf5345855842c4f3d347f6750f02ec76513fa2493"

      def install
        bin.install "gitops"
        bash_output = Utils.safe_popen_read(bin/"gitops", "completion", "bash")
        (bash_completion/"gitops").write bash_output
        zsh_output = Utils.safe_popen_read(bin/"gitops", "completion", "zsh")
        (zsh_completion/"_gitops").write zsh_output
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/J-Thompson12/weave-gitops/releases/download/v0.3.8-rc5/gitops-linux-arm64"
      sha256 "f19bc18d1806da747f75408286a9b2ad450b63c9556449e1efa107830cc06fea"

      def install
        bin.install "gitops"
        bash_output = Utils.safe_popen_read(bin/"gitops", "completion", "bash")
        (bash_completion/"gitops").write bash_output
        zsh_output = Utils.safe_popen_read(bin/"gitops", "completion", "zsh")
        (zsh_completion/"_gitops").write zsh_output
      end
    end
  end

  test do
    system "#{bin}/gitops version"
  end
end
