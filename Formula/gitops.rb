# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Gitops < Formula
  desc "GitOps support for Kubernetes"
  homepage "https://docs.gitops.weave.works/docs/getting-started"
  version "0.3.8-rc3"

  on_macos do
    if Hardware::CPU.arm?
      url "https://github.com/J-Thompson12/weave-gitops/releases/download/v0.3.8-rc3/gitops-darwin-arm64"
      sha256 "e90fc0b07eb6ce7d9967f7a6f0fbc43d27b354d9f1e8255e3478b035cd8eb863"

      def install
        bin.install "gitops"
        output = Utils.popen_read("#{bin}/gitops completion bash")
        (bash_completion/"gitops").write output
        output = Utils.popen_read("#{bin}/eksctl completion zsh")
        (zsh_completion/"_gitops").write output
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/J-Thompson12/weave-gitops/releases/download/v0.3.8-rc3/gitops-darwin-x86_64"
      sha256 "a45ddf67ad5b7bb2b56fcf4040e1c5bd3c6864152683bf8f789f3fc99ad0e8cb"

      def install
        bin.install "gitops"
        output = Utils.popen_read("#{bin}/gitops completion bash")
        (bash_completion/"gitops").write output
        output = Utils.popen_read("#{bin}/eksctl completion zsh")
        (zsh_completion/"_gitops").write output
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      url "https://github.com/J-Thompson12/weave-gitops/releases/download/v0.3.8-rc3/gitops-linux-x86_64"
      sha256 "e04abacf086c995eb8bf8c23e57cc8eed64a5289c50861ed63a68de185f1fc61"

      def install
        bin.install "gitops"
        output = Utils.popen_read("#{bin}/gitops completion bash")
        (bash_completion/"gitops").write output
        output = Utils.popen_read("#{bin}/eksctl completion zsh")
        (zsh_completion/"_gitops").write output
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/J-Thompson12/weave-gitops/releases/download/v0.3.8-rc3/gitops-linux-arm64"
      sha256 "01053f85839607893301a604d74fd25bfb553589b9c1137ba11db8be5ced30c9"

      def install
        bin.install "gitops"
        output = Utils.popen_read("#{bin}/gitops completion bash")
        (bash_completion/"gitops").write output
        output = Utils.popen_read("#{bin}/eksctl completion zsh")
        (zsh_completion/"_gitops").write output
      end
    end
  end

  test do
    system "#{bin}/gitops --version"
  end
end
